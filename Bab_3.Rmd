---
output: pdf_document
header-includes:
  \usepackage{amsmath}
  \usepackage{pdflscape}
---


# Analisa Hidrologi

## *Catchment Area*

Untuk dapat menghitung debit banjir dan debit andalan, diperlukan 2 (dua) inputan data utama. Input yang pertama adalah karakteristik dari catchment area yang ditinjau seperti luasan, panjang saluran, dan kemiringan saluran. Kemudian input kedua yang diperlukan adalah curah hujan rencana.  
Untuk data karakteristik sub DAS diperoleh dari deliniasi peta rupa bumi Indonesia (RBI) skala 1:25.000 yang bersumber dari Badan Informasi Geospasial dan validasi di lapangan. Hasil deliniasi pada ketiga lokasi yang ditinjau ditampilkan pada Gambar \ref{lokasidantabel}. Sedangkan zoom-in dari masing-masing catchment area dapat dilihat pada Gambar \ref{ca_bji} hingga Gambar \ref{ca_baranangsiang}. 

![Catchment Area Saluran Drainase Yang Ditinjau. \label{lokasidantabel}](gambar\lokasi_pekerjaan_plus_tabel.png)

<!-- <img src="gambar\lokasi_pekerjaan_plus_tabel.png" width="300" height="150" center> -->

![Catchment BJI. \label{ca_bji}](gambar\ca_bji.png)

![Catchment Kemuning. \label{ca_kemuning}](gambar\ca_kemuning.png)

![Catchment Baranangsiang. \label{ca_baranangsiang}](gambar\ca_baranangsiang.png)



## Data Stasiun Hujan

Di sekitar area sub DAS terdapat 1 (satu) stasiun pengamat yang terdekat, yaitu Stasiun Cisomang. Berikut ditampilkan posisi stasiun hujan terhadap sub DAS serta tabel koordinat data hujan yang akan digunakan.

![*Overlay* Lokasi Pos Hujan Terhadap *Catchment Area*. \label{peta_pos_hujan}](gambar\peta_pos_hujan.png)

```{r, include=TRUE, echo=FALSE, message=FALSE}
library(readxl)
library(dplyr)
library(kableExtra)

Koordinat_Pos_Hujan <- read_excel("data_and_code/Koordinat_Pos_Hujan.xlsx", 
    col_types = c("numeric", "text", "text", 
        "text", "text", "skip", "skip"))

kable(Koordinat_Pos_Hujan, "latex", escape=FALSE, booktabs=TRUE, linesep="", caption="Koordinat Pos Hujan.\\label{tbl_pos_hujan}") %>%
    kable_styling(latex_options=c("HOLD_position"))
```

Ketersediaan data untuk Stasiun Cisomang adalah curah hujan harian selama 24 tahun yaitu dari tahun 1995 sampai dengan tahun 2018. Rekapitulasi curah hujan yang akan digunakan ditampilkan pada Tabel \ref{hujan-max} dan Gambar \ref{data-hujan}.

```{r data-hujan, fig.cap="Data Stasiun Hujan \\label{data-hujan}",echo=FALSE}
library(ggplot2)

# jenis data debit atau curah hujan?
dbt <- "Debit"
hjn <- "Hujan"
dbt_title <- expression("Debit Harian"~(m^3/dtk))
dbt_labs <- expression("Debit"~(m^3/dtk))
hjn_title <- "Nilai Curah Hujan (mm)"
hjn_labs <- "Curah Hujan (mm)"

jenis_data <- hjn        # rubah sesuai jenis data yang ada, hujan atau debit?
judul_data <- hjn_title  # rubah sesuai jenis data yang ada, hujan atau debit?
judul_label <- hjn_labs  # rubah sesuai jenis data yang ada, hujan atau debit?


nama_pos <- "Stasiun Hujan Cisomang"

data <- read.csv("data_and_code/sta_cisomang.csv") #input data dari excel
names(data) <- c("Tanggal",jenis_data) # rubah nama
data <- subset(data,data[,2] != "-") 
data <- data[,1:2]

data$Tanggal <- as.Date(data[,1],format="%d-%b-%y") #cek format tanggal dari data original.
data[,2] <- as.numeric(as.character(data[,2])) #JANGAN LUPA as.character.

g <- ggplot(data,aes(x=Tanggal, y=Hujan))+geom_line(col="blue3") + 
  labs(title=judul_data,subtitle = nama_pos,x = "Waktu",y=judul_label) +
  theme_update(plot.title=element_text(hjust=0.5))+
  theme_update(plot.subtitle=element_text(hjust=0.5))+
  theme_update(axis.title.y=element_text(angle=90))+
  theme(plot.background = element_rect(colour = "black", size = 0.5))

index_max <- data[,2] == max(data[,2])
index_min <- data[,2] == min(data[,2])
max_min_plot <- ggplot(data,aes(x=Tanggal, y=data[,2]),label=jenis_data)+geom_line(color="blue3") + 
  labs(title=judul_data,subtitle = nama_pos,x = "Waktu",y=judul_label) +
  geom_point(data=data[index_max,],aes(Tanggal,Hujan,color="MAX"))+
  geom_point(data=data[index_min,],aes(Tanggal,Hujan,color="MIN"))+
  geom_text(aes(label=ifelse(Hujan==max(Hujan),as.character(Hujan),'')),hjust=-0.5,vjust=0.5)

kejadian_max <- data[index_max,]
tanggal_max <- kejadian_max[,1]
tanggal_max
nilai_max <- max(data[,2])

max_min_plot

```

Hujan maksimum yang terjadi di `r nama_pos` adalah `r nilai_max` mm pada `r tanggal_max`.


```{r hujan-max, echo=FALSE, message=FALSE, include=TRUE}
library(ggplot2)
library(dplyr)
library(lubridate)
library(kableExtra)


# cek struktur data
# str(data)

# tambah kolom tahun, bulan, dan hari
data$DOY <- as.numeric(yday(data$Tanggal))
data$Tahun <- as.numeric(format(data$Tanggal,"%Y"))
data$Bulan <- as.numeric(format(data$Tanggal,"%m"))

data_max <- data %>%
  group_by(Tahun) %>% 
  summarise(Hujan_Max = max(Hujan))

kable(data_max,"latex", booktabs=TRUE, linesep="", caption="Data Hujan Maksimum.\\label{hujan-max}") %>% kable_styling(latex_options=c("HOLD_position"))

# kable(data_max, "latex", escape=FALSE, booktabs=TRUE, linesep="", caption="Hujan Maksimum.\\label{hujan-max}") %>%
#     kable_styling(latex_options=c("HOLD_position"))
```




## Uji Outlier

Sebelum data hujan dipakai dalam analisa maka diperlukan pemeriksaan terlebih dahulu untuk memastikan bahwa data yang tercatat adalah benar secara statistik. Salah satu metode pemeriksaan yang umum digunakan adalah uji outlier. Pada pemeriksaan adanya outlier, seri data hujan harian maksimum tahunan, baik outlier atas maupun outlier bawah dilakukan dengan metoda yang dikembangkan oleh Water Resource Council (1981). Bila terdapat outlier, maka data outlier harus dipertimbangkan secara teknis sebelum seri data digunakan untuk analisis hidrologi lebih lanjut.
Persamaan frekuensi untuk mendeteksi adanya outlier atas adalah :

**insert rumus**

## Landscape Page
Coba halaman landscape

\begin{landscape}

```{r, include=TRUE, echo=FALSE, message=FALSE, warning=FALSE, fig.height=5.2, fig.width=9.5, fig.align="center", fig.cap="petal versus septal width\\label{fig:figLand}"}

  plot(x=iris$Petal.Width, y=iris$Sepal.Width, xlab="petal", ylab="sepal")

```

\end{landscape}

